#include "linear_approx.h"
#include <stdio.h>
#include <math.h>

void generate_linear_approximation(double min, double max, double inc) {
    double SCALE_IN = pow(2, SF_ATAN_IN);
    double SCALE_OUT = pow(2, SF_ATAN_OUT);
    double SLOPE_SF = SCALE_OUT / SCALE_IN;
    int intervals = (max - min) / inc;
    double slopes[intervals];
    double intercepts[intervals];
    double lower_x = min;
    double upper_x = min + inc;
    int i = 0;
    while (upper_x <= max) {
        slopes[i] = SLOPE_SF * ((atan(upper_x) - atan(lower_x)) / (upper_x - lower_x)) / 2;
        double avg_x = (lower_x + upper_x) / 2.0;
        double slope_result = (slopes[i] * (avg_x * SCALE_IN));
        double atan_result = atan(avg_x) * (SCALE_OUT / M_PI);
        double percent_diff = 100 * fabs(slope_result - atan_result) / atan_result;
        //printf("    slope result = %f, atan result = %f\n, diff = %f, percent diff = %f\n", slope_result, atan_result, slope_result - atan_result, percent_diff);
        intercepts[i] = slope_result - atan_result;
        if (lower_x == min) {
            printf("if (%f <= X && X < %f) { return (%f * X) + %f; }\n", lower_x * SCALE_IN, upper_x * SCALE_IN, slopes[i], intercepts[i]);
        }
        else {
            printf("else if (%f <= X && X < %f) { return (%f * X) + %f; }\n", lower_x * SCALE_IN, upper_x * SCALE_IN, slopes[i], intercepts[i]);
        }
        upper_x += inc;
        lower_x += inc;
        ++i;
    }

    //int MIN = min * pow(2, SF_ATAN_IN);
    //int MAX = max * pow(2, SF_ATAN_IN);
    //int INC = inc * pow(2, SF_ATAN_IN);
    //double SLOPE_SF = pow(2, SF_ATAN_OUT - SF_ATAN_IN);
    //int intervals = (MAX - MIN) / INC;
    //double slopes[intervals];
    //double intercepts[intervals];
    //int lower_X = MIN;
    //int upper_X = (MIN + INC);
    //int i = 0;
    //for (int lower_X = MIN; upper_X <= MAX; lower_X += INC) {
    //    double lower_x = (double)lower_X / pow(2, SF_ATAN_IN);
    //    double upper_x = (double)upper_X / pow(2, SF_ATAN_IN);
    //    double rate_of_change = ((atan(upper_x) - atan(lower_x)) / (upper_x - lower_x));
    //    slopes[i] = SLOPE_SF * rate_of_change;
    //    double atan_output = (0.5 * (atan(upper_X) + atan(lower_X)) * pow(2, SF_ATAN_OUT)/M_PI);
    //    double arctan_approx = ((slopes[i] * (upper_X + lower_X) * 0.5));
    //    printf("-------\natan_output = %f, arctan_approx = %f\n----------\n", atan_output, arctan_approx);
    //    intercepts[i] = (int)(atan_output - arctan_approx);
    //    if (lower_X == MIN) {
    //        printf("if (%d <= X && X < %d) { return (%d * X) + %d; }\n", lower_X, upper_X, (int)(slopes[i]), (int)(intercepts[i]));
    //    } else {
    //        printf("else if (%d <= X && X < %d) { return (%d * X) + %d; }\n", lower_X, upper_X, (int)(slopes[i]), (int)(intercepts[i]));
    //    }
    //    upper_X += INC;
    //    ++i;
    //}
}

void eval_error() {
    double max_error = 0;
    double error = 0;
    double inc = 0.001;
    for (double x = -1.0; x < 1.0; x += inc) {
        error = (int_arctan(x) - atan(x));
        printf("x = %f, int_arctan(x) = %d, atan(x) = %f, diff error: %f\n", x, int_arctan(x), atan(x), error);
        if (error > max_error) {
            max_error = error;
        }
    }
    for (double x = -8192; x <= 8192; x++) {
        error = (int_arctan(x)  - atan(x));
        printf("x = %f, int_arctan(x) = %d, atan(x) = %f, diff error: %f\n", x, int_arctan(x), atan(x), error);
        if (error > max_error) {
            max_error = error;
        }
    }
    printf("Max error: %f\n", max_error);
}

int arctan(int X) {
    // max input magnitude is 2^31
    //int min_input = 0x80000000,
    //    max_input = 0x7FFFFFFF;
    //printf("%d\n", min_input >> SF_ATAN_IN);
    //printf("%d\n", max_input >> SF_ATAN_IN);
    //generate_linear_approximation(-1.0, 1.0, 0.01);
    return int_arctan(X);
}

int arccot(int X) {
    return 0;
}

int adjust_angle(int arccot, int X) {
    return 0;
}

int int_arctan(int X) {
    if (-16384.000000 <= X && X < -16220.160000) { return (32932.386117 * X) + -1708673.659494; }
    else if (-16220.160000 <= X && X < -16056.320000) { return (33263.342417 * X) + -5106273.476917; }
    else if (-16056.320000 <= X && X < -15892.480000) { return (33597.572984 * X) + -8482420.788127; }
    else if (-15892.480000 <= X && X < -15728.640000) { return (33935.073669 * X) + -11835781.940658; }
    else if (-15728.640000 <= X && X < -15564.800000) { return (34275.838100 * X) + -15164990.692898; }
    else if (-15564.800000 <= X && X < -15400.960000) { return (34619.857577 * X) + -18468648.138559; }
    else if (-15400.960000 <= X && X < -15237.120000) { return (34967.120959 * X) + -21745322.680761; }
    else if (-15237.120000 <= X && X < -15073.280000) { return (35317.614557 * X) + -24993550.059486; }
    else if (-15073.280000 <= X && X < -14909.440000) { return (35671.322012 * X) + -28211833.436020; }
    else if (-14909.440000 <= X && X < -14745.600000) { return (36028.224181 * X) + -31398643.538434; }
    else if (-14745.600000 <= X && X < -14581.760000) { return (36388.299013 * X) + -34552418.871909; }
    else if (-14581.760000 <= X && X < -14417.920000) { return (36751.521428 * X) + -37671565.998174; }
    else if (-14417.920000 <= X && X < -14254.080000) { return (37117.863189 * X) + -40754459.888302; }
    else if (-14254.080000 <= X && X < -14090.240000) { return (37487.292774 * X) + -43799444.353048; }
    else if (-14090.240000 <= X && X < -13926.400000) { return (37859.775247 * X) + -46804832.555432; }
    else if (-13926.400000 <= X && X < -13762.560000) { return (38235.272123 * X) + -49768907.609867; }
    else if (-13762.560000 <= X && X < -13598.720000) { return (38613.741236 * X) + -52689923.272645; }
    else if (-13598.720000 <= X && X < -13434.880000) { return (38995.136600 * X) + -55566104.728284; }
    else if (-13434.880000 <= X && X < -13271.040000) { return (39379.408275 * X) + -58395649.476641; }
    else if (-13271.040000 <= X && X < -13107.200000) { return (39766.502226 * X) + -61176728.325546; }
    else if (-13107.200000 <= X && X < -12943.360000) { return (40156.360185 * X) + -63907486.493581; }
    else if (-12943.360000 <= X && X < -12779.520000) { return (40548.919507 * X) + -66586044.827986; }
    else if (-12779.520000 <= X && X < -12615.680000) { return (40944.113037 * X) + -69210501.142436; }
    else if (-12615.680000 <= X && X < -12451.840000) { return (41341.868962 * X) + -71778931.679213; }
    else if (-12451.840000 <= X && X < -12288.000000) { return (41742.110678 * X) + -74289392.700779; }
    else if (-12288.000000 <= X && X < -12124.160000) { return (42144.756647 * X) + -76739922.214908; }
    else if (-12124.160000 <= X && X < -11960.320000) { return (42549.720257 * X) + -79128541.837945; }
    else if (-11960.320000 <= X && X < -11796.480000) { return (42956.909695 * X) + -81453258.800598; }
    else if (-11796.480000 <= X && X < -11632.640000) { return (43366.227805 * X) + -83712068.099881; }
    else if (-11632.640000 <= X && X < -11468.800000) { return (43777.571962 * X) + -85902954.801505; }
    else if (-11468.800000 <= X && X < -11304.960000) { return (44190.833942 * X) + -88023896.495761; }
    else if (-11304.960000 <= X && X < -11141.120000) { return (44605.899803 * X) + -90072865.910352; }
    else if (-11141.120000 <= X && X < -10977.280000) { return (45022.649761 * X) + -92047833.682959; }
    else if (-10977.280000 <= X && X < -10813.440000) { return (45440.958081 * X) + -93946771.295789; }
    else if (-10813.440000 <= X && X < -10649.600000) { return (45860.692969 * X) + -95767654.174257; }
    else if (-10649.600000 <= X && X < -10485.760000) { return (46281.716469 * X) + -97508464.950972; }
    else if (-10485.760000 <= X && X < -10321.920000) { return (46703.884374 * X) + -99167196.896057; }
    else if (-10321.920000 <= X && X < -10158.080000) { return (47127.046137 * X) + -100741857.513963; }
    else if (-10158.080000 <= X && X < -9994.240000) { return (47551.044798 * X) + -102230472.306246; }
    else if (-9994.240000 <= X && X < -9830.400000) { return (47975.716915 * X) + -103631088.699291; }
    else if (-9830.400000 <= X && X < -9666.560000) { return (48400.892514 * X) + -104941780.134786; }
    else if (-9666.560000 <= X && X < -9502.720000) { return (48826.395039 * X) + -106160650.320298; }
    else if (-9502.720000 <= X && X < -9338.880000) { return (49252.041326 * X) + -107285837.636150; }
    else if (-9338.880000 <= X && X < -9175.040000) { return (49677.641580 * X) + -108315519.694005; }
    else if (-9175.040000 <= X && X < -9011.200000) { return (50102.999377 * X) + -109247918.041284; }
    else if (-9011.200000 <= X && X < -8847.360000) { return (50527.911670 * X) + -110081303.004962; }
    else if (-8847.360000 <= X && X < -8683.520000) { return (50952.168821 * X) + -110813998.666687; }
    else if (-8683.520000 <= X && X < -8519.680000) { return (51375.554643 * X) + -111444387.960365; }
    else if (-8519.680000 <= X && X < -8355.840000) { return (51797.846460 * X) + -111970917.881958; }
    else if (-8355.840000 <= X && X < -8192.000000) { return (52218.815195 * X) + -112392104.800255; }
    else if (-8192.000000 <= X && X < -8028.160000) { return (52638.225463 * X) + -112706539.855793; }
    else if (-8028.160000 <= X && X < -7864.320000) { return (53055.835695 * X) + -112912894.434261; }
    else if (-7864.320000 <= X && X < -7700.480000) { return (53471.398282 * X) + -113009925.699068; }
    else if (-7700.480000 <= X && X < -7536.640000) { return (53884.659734 * X) + -112996482.166653; }
    else if (-7536.640000 <= X && X < -7372.800000) { return (54295.360870 * X) + -112871509.306884; }
    else if (-7372.800000 <= X && X < -7208.960000) { return (54703.237026 * X) + -112634055.149479; }
    else if (-7208.960000 <= X && X < -7045.120000) { return (55108.018289 * X) + -112283275.876246; }
    else if (-7045.120000 <= X && X < -6881.280000) { return (55509.429751 * X) + -111818441.377747; }
    else if (-6881.280000 <= X && X < -6717.440000) { return (55907.191796 * X) + -111238940.751776; }
    else if (-6717.440000 <= X && X < -6553.600000) { return (56301.020400 * X) + -110544287.720017; }
    else if (-6553.600000 <= X && X < -6389.760000) { return (56690.627470 * X) + -109734125.938164; }
    else if (-6389.760000 <= X && X < -6225.920000) { return (57075.721191 * X) + -108808234.174023; }
    else if (-6225.920000 <= X && X < -6062.080000) { return (57456.006416 * X) + -107766531.327039; }
    else if (-6062.080000 <= X && X < -5898.240000) { return (57831.185067 * X) + -106609081.262259; }
    else if (-5898.240000 <= X && X < -5734.400000) { return (58200.956567 * X) + -105336097.431042; }
    else if (-5734.400000 <= X && X < -5570.560000) { return (58565.018296 * X) + -103947947.250361; }
    else if (-5570.560000 <= X && X < -5406.720000) { return (58923.066064 * X) + -102445156.212461; }
    else if (-5406.720000 <= X && X < -5242.880000) { return (59274.794619 * X) + -100828411.696327; }
    else if (-5242.880000 <= X && X < -5079.040000) { return (59619.898164 * X) + -99098566.452734; }
    else if (-5079.040000 <= X && X < -4915.200000) { return (59958.070900 * X) + -97256641.734746; }
    else if (-4915.200000 <= X && X < -4751.360000) { return (60289.007592 * X) + -95303830.046220; }
    else if (-4751.360000 <= X && X < -4587.520000) { return (60612.404149 * X) + -93241497.481425; }
    else if (-4587.520000 <= X && X < -4423.680000) { return (60927.958217 * X) + -91071185.629933; }
    else if (-4423.680000 <= X && X < -4259.840000) { return (61235.369797 * X) + -88794613.022087; }
    else if (-4259.840000 <= X && X < -4096.000000) { return (61534.341866 * X) + -86413676.091655; }
    else if (-4096.000000 <= X && X < -3932.160000) { return (61824.581016 * X) + -83930449.634073; }
    else if (-3932.160000 <= X && X < -3768.320000) { return (62105.798096 * X) + -81347186.740356; }
    else if (-3768.320000 <= X && X < -3604.480000) { return (62377.708865 * X) + -78666318.188968; }
    else if (-3604.480000 <= X && X < -3440.640000) { return (62640.034652 * X) + -75890451.280142; }
    else if (-3440.640000 <= X && X < -3276.800000) { return (62892.503007 * X) + -73022368.099734; }
    else if (-3276.800000 <= X && X < -3112.960000) { return (63134.848361 * X) + -70065023.202309; }
    else if (-3112.960000 <= X && X < -2949.120000) { return (63366.812680 * X) + -67021540.706089; }
    else if (-2949.120000 <= X && X < -2785.280000) { return (63588.146110 * X) + -63895210.795442; }
    else if (-2785.280000 <= X && X < -2621.440000) { return (63798.607617 * X) + -60689485.629719; }
    else if (-2621.440000 <= X && X < -2457.600000) { return (63997.965611 * X) + -57407974.660636; }
    else if (-2457.600000 <= X && X < -2293.760000) { return (64185.998557 * X) + -54054439.363718; }
    else if (-2293.760000 <= X && X < -2129.920000) { return (64362.495567 * X) + -50632787.392849; }
    else if (-2129.920000 <= X && X < -1966.080000) { return (64527.256976 * X) + -47147066.170446; }
    else if (-1966.080000 <= X && X < -1802.240000) { return (64680.094888 * X) + -43601455.929315; }
    else if (-1802.240000 <= X && X < -1638.400000) { return (64820.833700 * X) + -40000262.225710; }
    else if (-1638.400000 <= X && X < -1474.560000) { return (64949.310595 * X) + -36347907.946585; }
    else if (-1474.560000 <= X && X < -1310.720000) { return (65065.376008 * X) + -32648924.837362; }
    else if (-1310.720000 <= X && X < -1146.880000) { return (65168.894051 * X) + -28907944.579757; }
    else if (-1146.880000 <= X && X < -983.040000) { return (65259.742910 * X) + -25129689.452310; }
    else if (-983.040000 <= X && X < -819.200000) { return (65337.815199 * X) + -21318962.609124; }
    else if (-819.200000 <= X && X < -655.360000) { return (65403.018272 * X) + -17480638.015011; }
    else if (-655.360000 <= X && X < -491.520000) { return (65455.274501 * X) + -13619650.077683; }
    else if (-491.520000 <= X && X < -327.680000) { return (65494.521504 * X) + -9740983.019779; }
    else if (-327.680000 <= X && X < -163.840000) { return (65520.712329 * X) + -5849660.035392; }
    else if (-163.840000 <= X && X < 0.000000) { return (65533.815598 * X) + -1950732.277343; }
    else if (0.000000 <= X && X < 163.840000) { return (65533.815598 * X) + 1950732.277343; }
    else if (163.840000 <= X && X < 327.680000) { return (65520.712329 * X) + 5849660.035393; }
    else if (327.680000 <= X && X < 491.520000) { return (65494.521504 * X) + 9740983.019780; }
    else if (491.520000 <= X && X < 655.360000) { return (65455.274501 * X) + 13619650.077684; }
    else if (655.360000 <= X && X < 819.200000) { return (65403.018272 * X) + 17480638.015011; }
    else if (819.200000 <= X && X < 983.040000) { return (65337.815199 * X) + 21318962.609125; }
    else if (983.040000 <= X && X < 1146.880000) { return (65259.742910 * X) + 25129689.452311; }
    else if (1146.880000 <= X && X < 1310.720000) { return (65168.894051 * X) + 28907944.579757; }
    else if (1310.720000 <= X && X < 1474.560000) { return (65065.376008 * X) + 32648924.837362; }
    else if (1474.560000 <= X && X < 1638.400000) { return (64949.310595 * X) + 36347907.946586; }
    else if (1638.400000 <= X && X < 1802.240000) { return (64820.833700 * X) + 40000262.225710; }
    else if (1802.240000 <= X && X < 1966.080000) { return (64680.094888 * X) + 43601455.929316; }
    else if (1966.080000 <= X && X < 2129.920000) { return (64527.256976 * X) + 47147066.170447; }
    else if (2129.920000 <= X && X < 2293.760000) { return (64362.495567 * X) + 50632787.392849; }
    else if (2293.760000 <= X && X < 2457.600000) { return (64185.998557 * X) + 54054439.363719; }
    else if (2457.600000 <= X && X < 2621.440000) { return (63997.965611 * X) + 57407974.660637; }
    else if (2621.440000 <= X && X < 2785.280000) { return (63798.607617 * X) + 60689485.629720; }
    else if (2785.280000 <= X && X < 2949.120000) { return (63588.146110 * X) + 63895210.795442; }
    else if (2949.120000 <= X && X < 3112.960000) { return (63366.812680 * X) + 67021540.706090; }
    else if (3112.960000 <= X && X < 3276.800000) { return (63134.848361 * X) + 70065023.202309; }
    else if (3276.800000 <= X && X < 3440.640000) { return (62892.503007 * X) + 73022368.099734; }
    else if (3440.640000 <= X && X < 3604.480000) { return (62640.034652 * X) + 75890451.280142; }
    else if (3604.480000 <= X && X < 3768.320000) { return (62377.708865 * X) + 78666318.188968; }
    else if (3768.320000 <= X && X < 3932.160000) { return (62105.798096 * X) + 81347186.740357; }
    else if (3932.160000 <= X && X < 4096.000000) { return (61824.581016 * X) + 83930449.634073; }
    else if (4096.000000 <= X && X < 4259.840000) { return (61534.341866 * X) + 86413676.091655; }
    else if (4259.840000 <= X && X < 4423.680000) { return (61235.369797 * X) + 88794613.022087; }
    else if (4423.680000 <= X && X < 4587.520000) { return (60927.958217 * X) + 91071185.629933; }
    else if (4587.520000 <= X && X < 4751.360000) { return (60612.404149 * X) + 93241497.481424; }
    else if (4751.360000 <= X && X < 4915.200000) { return (60289.007592 * X) + 95303830.046220; }
    else if (4915.200000 <= X && X < 5079.040000) { return (59958.070900 * X) + 97256641.734746; }
    else if (5079.040000 <= X && X < 5242.880000) { return (59619.898164 * X) + 99098566.452734; }
    else if (5242.880000 <= X && X < 5406.720000) { return (59274.794619 * X) + 100828411.696327; }
    else if (5406.720000 <= X && X < 5570.560000) { return (58923.066064 * X) + 102445156.212461; }
    else if (5570.560000 <= X && X < 5734.400000) { return (58565.018296 * X) + 103947947.250361; }
    else if (5734.400000 <= X && X < 5898.240000) { return (58200.956567 * X) + 105336097.431042; }
    else if (5898.240000 <= X && X < 6062.080000) { return (57831.185067 * X) + 106609081.262259; }
    else if (6062.080000 <= X && X < 6225.920000) { return (57456.006416 * X) + 107766531.327037; }
    else if (6225.920000 <= X && X < 6389.760000) { return (57075.721191 * X) + 108808234.174025; }
    else if (6389.760000 <= X && X < 6553.600000) { return (56690.627470 * X) + 109734125.938165; }
    else if (6553.600000 <= X && X < 6717.440000) { return (56301.020400 * X) + 110544287.720015; }
    else if (6717.440000 <= X && X < 6881.280000) { return (55907.191796 * X) + 111238940.751776; }
    else if (6881.280000 <= X && X < 7045.120000) { return (55509.429751 * X) + 111818441.377747; }
    else if (7045.120000 <= X && X < 7208.960000) { return (55108.018289 * X) + 112283275.876247; }
    else if (7208.960000 <= X && X < 7372.800000) { return (54703.237026 * X) + 112634055.149477; }
    else if (7372.800000 <= X && X < 7536.640000) { return (54295.360870 * X) + 112871509.306887; }
    else if (7536.640000 <= X && X < 7700.480000) { return (53884.659734 * X) + 112996482.166651; }
    else if (7700.480000 <= X && X < 7864.320000) { return (53471.398282 * X) + 113009925.699069; }
    else if (7864.320000 <= X && X < 8028.160000) { return (53055.835695 * X) + 112912894.434261; }
    else if (8028.160000 <= X && X < 8192.000000) { return (52638.225463 * X) + 112706539.855792; }
    else if (8192.000000 <= X && X < 8355.840000) { return (52218.815195 * X) + 112392104.800252; }
    else if (8355.840000 <= X && X < 8519.680000) { return (51797.846460 * X) + 111970917.881962; }
    else if (8519.680000 <= X && X < 8683.520000) { return (51375.554643 * X) + 111444387.960362; }
    else if (8683.520000 <= X && X < 8847.360000) { return (50952.168821 * X) + 110813998.666688; }
    else if (8847.360000 <= X && X < 9011.200000) { return (50527.911670 * X) + 110081303.004962; }
    else if (9011.200000 <= X && X < 9175.040000) { return (50102.999377 * X) + 109247918.041284; }
    else if (9175.040000 <= X && X < 9338.880000) { return (49677.641580 * X) + 108315519.694005; }
    else if (9338.880000 <= X && X < 9502.720000) { return (49252.041326 * X) + 107285837.636151; }
    else if (9502.720000 <= X && X < 9666.560000) { return (48826.395039 * X) + 106160650.320292; }
    else if (9666.560000 <= X && X < 9830.400000) { return (48400.892514 * X) + 104941780.134786; }
    else if (9830.400000 <= X && X < 9994.240000) { return (47975.716915 * X) + 103631088.699299; }
    else if (9994.240000 <= X && X < 10158.080000) { return (47551.044798 * X) + 102230472.306246; }
    else if (10158.080000 <= X && X < 10321.920000) { return (47127.046137 * X) + 100741857.513956; }
    else if (10321.920000 <= X && X < 10485.760000) { return (46703.884374 * X) + 99167196.896057; }
    else if (10485.760000 <= X && X < 10649.600000) { return (46281.716469 * X) + 97508464.950973; }
    else if (10649.600000 <= X && X < 10813.440000) { return (45860.692969 * X) + 95767654.174257; }
    else if (10813.440000 <= X && X < 10977.280000) { return (45440.958081 * X) + 93946771.295790; }
    else if (10977.280000 <= X && X < 11141.120000) { return (45022.649761 * X) + 92047833.682959; }
    else if (11141.120000 <= X && X < 11304.960000) { return (44605.899803 * X) + 90072865.910353; }
    else if (11304.960000 <= X && X < 11468.800000) { return (44190.833942 * X) + 88023896.495761; }
    else if (11468.800000 <= X && X < 11632.640000) { return (43777.571962 * X) + 85902954.801505; }
    else if (11632.640000 <= X && X < 11796.480000) { return (43366.227805 * X) + 83712068.099881; }
    else if (11796.480000 <= X && X < 11960.320000) { return (42956.909695 * X) + 81453258.800590; }
    else if (11960.320000 <= X && X < 12124.160000) { return (42549.720257 * X) + 79128541.837945; }
    else if (12124.160000 <= X && X < 12288.000000) { return (42144.756647 * X) + 76739922.214909; }
    else if (12288.000000 <= X && X < 12451.840000) { return (41742.110678 * X) + 74289392.700788; }
    else if (12451.840000 <= X && X < 12615.680000) { return (41341.868962 * X) + 71778931.679204; }
    else if (12615.680000 <= X && X < 12779.520000) { return (40944.113037 * X) + 69210501.142437; }
    else if (12779.520000 <= X && X < 12943.360000) { return (40548.919507 * X) + 66586044.827986; }
    else if (12943.360000 <= X && X < 13107.200000) { return (40156.360185 * X) + 63907486.493581; }
    else if (13107.200000 <= X && X < 13271.040000) { return (39766.502226 * X) + 61176728.325546; }
    else if (13271.040000 <= X && X < 13434.880000) { return (39379.408275 * X) + 58395649.476642; }
    else if (13434.880000 <= X && X < 13598.720000) { return (38995.136600 * X) + 55566104.728275; }
    else if (13598.720000 <= X && X < 13762.560000) { return (38613.741236 * X) + 52689923.272645; }
    else if (13762.560000 <= X && X < 13926.400000) { return (38235.272123 * X) + 49768907.609877; }
    else if (13926.400000 <= X && X < 14090.240000) { return (37859.775247 * X) + 46804832.555432; }
    else if (14090.240000 <= X && X < 14254.080000) { return (37487.292774 * X) + 43799444.353038; }
    else if (14254.080000 <= X && X < 14417.920000) { return (37117.863189 * X) + 40754459.888302; }
    else if (14417.920000 <= X && X < 14581.760000) { return (36751.521428 * X) + 37671565.998174; }
    else if (14581.760000 <= X && X < 14745.600000) { return (36388.299013 * X) + 34552418.871909; }
    else if (14745.600000 <= X && X < 14909.440000) { return (36028.224181 * X) + 31398643.538445; }
    else if (14909.440000 <= X && X < 15073.280000) { return (35671.322012 * X) + 28211833.436010; }
    else if (15073.280000 <= X && X < 15237.120000) { return (35317.614557 * X) + 24993550.059486; }
    else if (15237.120000 <= X && X < 15400.960000) { return (34967.120959 * X) + 21745322.680761; }
    else if (15400.960000 <= X && X < 15564.800000) { return (34619.857577 * X) + 18468648.138559; }
    else if (15564.800000 <= X && X < 15728.640000) { return (34275.838100 * X) + 15164990.692899; }
    else if (15728.640000 <= X && X < 15892.480000) { return (33935.073669 * X) + 11835781.940658; }
    else if (15892.480000 <= X && X < 16056.320000) { return (33597.572984 * X) + 8482420.788127; }
    else if (16056.320000 <= X && X < 16220.160000) { return (33263.342417 * X) + 5106273.476917; }
    else { 
        return adjust_angle(arccot(X), X);
    }
}